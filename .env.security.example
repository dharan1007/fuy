# ============================================================
# SECURITY CONFIGURATION
# ============================================================
# Copy this file to .env.security and fill in your values
# NEVER commit .env.security to git - it contains secrets!
# ============================================================

# ===== API SECURITY =====

# API Request Signing Secret (use a strong 32+ character string)
API_REQUEST_SECRET=your-super-secret-api-request-key-minimum-32-characters

# Hash Secret for sensitive data
HASH_SECRET=your-hash-secret-minimum-32-characters

# ===== CORS & ORIGIN VALIDATION =====

# Comma-separated list of trusted origins
TRUSTED_ORIGINS=http://localhost:3000,https://yourapp.com,https://www.yourapp.com

# ===== RATE LIMITING =====

# Rate limit: requests per 15-minute window per IP
RATE_LIMIT_REQUESTS=100

# Rate limit: requests per 15-minute window for authenticated users
AUTH_RATE_LIMIT_REQUESTS=500

# Rate limit window in milliseconds (default: 15 minutes)
RATE_LIMIT_WINDOW_MS=900000

# ===== SESSION & JWT =====

# NextAuth.js secret (use `openssl rand -base64 32` to generate)
NEXTAUTH_SECRET=your-nextauth-secret-minimum-32-characters

# JWT expiration time (in seconds, default: 30 days)
JWT_EXPIRATION=2592000

# Session max age (in seconds, default: 30 days)
SESSION_MAX_AGE=2592000

# ===== PASSWORD SECURITY =====

# BCrypt salt rounds (10-12 recommended)
BCRYPT_ROUNDS=12

# Minimum password length (recommended: 8+)
MIN_PASSWORD_LENGTH=8

# ===== DATA PROTECTION =====

# Enable request payload size validation (in bytes, default: 1MB)
MAX_PAYLOAD_SIZE=1048576

# Enable audit logging
ENABLE_AUDIT_LOG=true

# Data retention period (in days)
DATA_RETENTION_DAYS=90

# ===== SECURITY HEADERS =====

# Content Security Policy enforcement level
CSP_ENFORCEMENT=block

# Enable HSTS (HTTP Strict Transport Security) in production
ENABLE_HSTS=true

# ===== ENCRYPTION =====

# Encryption key for sensitive data (must be 32 characters)
ENCRYPTION_KEY=your-encryption-key-exactly-32-characters

# Encryption algorithm
ENCRYPTION_ALGORITHM=aes-256-gcm

# ===== API VERSIONING =====

# Current API version
API_VERSION=v1

# Minimum supported API version
MIN_API_VERSION=v1

# ===== SECURITY MONITORING =====

# Enable security event logging
SECURITY_LOG_ENABLED=true

# Suspicious activity alert threshold
SUSPICIOUS_ACTIVITY_THRESHOLD=5

# Lockout duration after failed attempts (in minutes)
ACCOUNT_LOCKOUT_DURATION=15

# Maximum failed login attempts before lockout
MAX_FAILED_LOGIN_ATTEMPTS=5

# ===== EXTERNAL SERVICE SECURITY =====

# OAuth provider secrets (keep secure!)
GITHUB_SECRET=your-github-oauth-secret
GOOGLE_SECRET=your-google-oauth-secret

# API keys for third-party services
STRIPE_SECRET_KEY=your-stripe-secret-key
SENDGRID_API_KEY=your-sendgrid-api-key

# ===== DEVELOPMENT SECURITY =====

# Environment (development, staging, production)
NODE_ENV=production

# Enable verbose security logging (disable in production)
DEBUG_SECURITY=false

# ===== VERSION & TRACKING =====

# Application version
NEXT_PUBLIC_APP_VERSION=1.0.0

# Build timestamp
BUILD_TIMESTAMP=2024-11-19T00:00:00Z
