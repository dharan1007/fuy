# Shop & Sell Feature Documentation

## 1. Feature Overview
**Feature Name:** Shop (Commerce)
**File Location:** `mobile/app/(tabs)/shop.tsx`
**Primary Purpose:** A marketplace for digital goods. Users can buy Courses, E-books, and Templates. Uniquely, any user can become a seller via the "Create Brand" flow.

## 2. Shop Interface (Buyer View)

### A. Layout
- **Header:** "SHOP" title, Cart icon with badge, Search toggle.
- **Auto-Scrolling Banners:**
    - "Courses", "Books", "Templates".
    - These sections scroll horizontally *automatically* (infinite loop) to create a dynamic window-shopping feel.
    - **Interaction:** User can grab and scroll manually; auto-scroll pauses then resumes.
- **Brand Cards:**
    - Wide rectangular cards showing Brand Logos/Names.
- **Product Grid:**
    - "Browse All" section.
    - Varied card sizes (Masonry-like feel) generated by `getCardDimensions(index)`.

### B. Product Card Design
- **Visual:** Full image background.
- **Overlay:** Gradient at bottom.
- **Text:** Minimalist. Price and Name overlay.
- **Action:** Tap navigates to Product Detail (`/shop/product/[id]`).

## 3. Sell / Create Brand Interface (Seller View)

### A. Create Brand (`shop/create-brand.tsx`)
**Entry Point:** "s.o. fuy" (Sell on Fuy) button in Shop header.
**The Flow:**
1.  **Logo Upload:** Circle avatar picker.
2.  **Brand Name:** Text input.
3.  **Description:** Text area.
4.  **Submit:** Creates a `Brand` entry in Supabase.

### B. Seller Dashboard
- **My Store:** Once a brand is created, the user gets a "Store" dashboard.
- **Product Management:** Add/Edit products (e.g., upload PDF for Ebook).
- **Sales Analytics:** (Implemented in Dashboard feature).

## 4. Data Structure
**Products Logic:**
- Filterable by `type`: 'COURSE', 'EBOOK', 'TEMPLATE'.
- **Placeholder Mode:** If API returns empty, the UI gracefully falls back to `PLACEHOLDER_PRODUCTS` to maintain design integrity during demos or loading.

**Brands Logic:**
- Users can own multiple Brands.
- Products belong to a Brand, not directly to a User.

## 5. Technical Details
- **Auto-Scroll Implementation:**
    - Uses `requestAnimationFrame` and `scrollTo`.
    - Duplicates data array `[...data, ...data, ...data]` to simulate infinity.
    - Logic handles seamless resetting of scroll position (e.g., jumping from end back to middle) to fool the eye.
- **Image Handling:**
    - `JSON.parse(images)` safe check since images are stored as JSON arrays in Postgres.

## 6. User Flows
1.  **Buying:**
    - Browse Shop -> Tap Product -> Add to Cart -> Checkout.
2.  **Selling:**
    - Tap "s.o. fuy" -> Create Brand "Design Wiz" -> Upload Logo.
    - Dashboard -> Add Product "UI Kit" -> Upload File -> Set Price $10.
    - Product appears in global Shop.

## 7. Edge Cases
- **No Data:** "Sample Data" banner appears to explain why placeholders are shown.
- **Error Handling:** `fetchData` wrapped in try/catch; defaults to placeholders on network failure.
